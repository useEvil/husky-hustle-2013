{% load custom_filters %}
{% if children %}
<span>Your search for <span class="bold">"{{ search|safe }}"</span> found <span class="bold">{{ children|length }}</span> results:</span>
<table class="search-results" border="1">
	<tr>
		<th>Parent</th><th>Student</th><th>Grade</th><th>Teacher</th>
	</tr>
	{% for child in children %}
	<tr>
		{% if child|is_linked:parent or child.parent.id == parent.id %}
		<td>{{ child.parent.full_name }}</td>
		{% else %}
		<td>{% if request.user.is_authenticated %}<a id="link_to" href="/request/link/{{ child.parent.id }}">{{ child.parent.full_name }}</a>{% else %}{{ child.parent.full_name }}{% endif %}</td>
		{% endif %}
		<td><a href="{{ child.donate_url }}">{{ child.full_name }}</a></td>
		<td>{{ child.teacher.grade }}</td>
		<td>{{ child.teacher.full_name }} ({{ child.teacher.room_number }})</td>
	</tr>
	{% endfor %}
</table>
{% else %}
{% if not parent_only %}
<h3>Search for a Student</h3>
{% else %}
<h3>Link to another Account</h3>
{% endif %}
<form action="/make-donation/search" method="GET" id="form_search">
	{% if not parent_only %}
	<ol>
		<li style="display: inline;"><label style="width: 200px;" for="student_name"{% if form.student_name.errors %} class="error"{% endif %}>Student First Name:</label><input id="student_name" type="text" name="student_name" value="{{ form.student_name.value }}" size="30" /></li>
	</ol>
	{% else %}
	<input type="hidden" name="parent_only" value="1" />
	{% endif %}
	<ol>
		<li style="display: inline;"><label style="width: 200px;" for="parent_name"{% if form.parent_name.errors %} class="error"{% endif %}>Parent Last Name:</label><input id="parent_name" type="text" name="parent_name" value="{{ form.parent_name.value }}" size="30" /></li>
		<li style="display: inline;padding-left: 15px;"><input type="button" style="width: 8em;" id="submit_search" class="control input submit" value=" Search " /></li>
	</ol>
</form>
{% endif %}